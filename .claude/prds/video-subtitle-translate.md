---
name: video-subtitle-translate
description: 从MP4视频音频中提取字幕并使用本地LLM进行多语言翻译，生成双语SRT字幕文件
status: backlog
created: 2025-09-05T01:00:16Z
---

# PRD: Video Subtitle Translate

## Executive Summary

视频字幕翻译系统是一个端到端的解决方案，能够从MP4视频文件中提取音频，生成字幕，并使用本地LLM进行高质量翻译。系统主要面向需要进行国际化内容发布的个人用户，提供中日英语言对的专业级翻译服务，输出标准格式的双语SRT字幕文件。

## Problem Statement

### 核心问题
- 个人内容创作者需要将视频内容国际化，但缺乏专业的字幕翻译工具
- 现有解决方案要么依赖昂贵的云端API，要么翻译质量不佳
- 手动创建和翻译字幕耗时巨大，影响内容发布效率

### 为什么现在重要
- 全球化内容需求快速增长
- 本地LLM技术成熟，可提供高质量翻译
- 个人创作者对隐私和成本控制要求高

## User Stories

### 主要用户画像
**个人内容创作者**
- 年龄：25-45岁
- 职业：YouTube博主、在线教育者、独立制片人
- 技术水平：中等，能使用命令行工具
- 目标：高效创建多语言字幕，扩大受众范围

### 用户使用流程

#### 故事1：基本翻译工作流
**作为一个**内容创作者，**我希望**能够一键从MP4视频生成翻译字幕，**这样**我就能快速发布多语言版本的内容。

**接受标准：**
- 输入MP4文件，输出SRT字幕文件
- 支持中→英、中→日、英→中、英→日、日→中、日→英翻译
- 翻译质量达到专业水准（BLEU score > 0.4）
- 处理30分钟视频的时间不超过10分钟

#### 故事2：字幕校对工作流
**作为一个**对质量有要求的创作者，**我希望**能够校对翻译结果，**这样**我就能确保字幕的准确性。

**接受标准：**
- 提供人工校对界面，可选择跳过
- 显示原文和译文对比
- 支持逐句编辑和修改
- 保存校对历史记录

#### 故事3：双语字幕显示
**作为一个**观众，**我希望**看到格式规范的双语字幕，**这样**我就能同时学习语言和理解内容。

**接受标准：**
- 上方显示翻译文本
- 下方显示原文
- 单行字幕显示时长2-5秒
- 最大字符数：中文25字符，英文50字符，日文25字符

## Requirements

### Functional Requirements

#### FR1: 音频提取与识别
- 从MP4视频文件中提取音频
- 使用语音识别技术（优先Whisper）生成原文字幕
- 自动检测音频语言
- 生成带时间轴的原始字幕

#### FR2: 本地LLM翻译
- 集成本地运行的LLM模型进行翻译
- 支持中日英三语言对（6个翻译方向）
- 保持字幕时间轴不变
- 优化翻译结果的字幕显示长度

#### FR3: 双语字幕生成
- 生成标准SRT格式字幕文件
- 上下双行显示：翻译+原文
- 符合字幕显示时长和字符数限制
- 自动格式化和断句优化

#### FR4: 人工校对功能（可选）
- 提供简单的校对界面
- 逐句对比原文、译文和时间轴
- 支持编辑和修改功能
- 可选择跳过校对直接输出

#### FR5: 文件管理
- 保存原始字幕和翻译字幕文件
- 生成翻译日志和元数据
- 支持项目管理和历史记录

### Non-Functional Requirements

#### NFR1: 性能要求
- 30分钟视频处理时间 < 10分钟
- 语音识别准确率 > 90%
- 翻译质量BLEU score > 0.4
- 内存占用 < 8GB

#### NFR2: 质量要求
- 字幕时间轴误差 < 0.5秒
- 翻译一致性和专业术语处理
- 格式符合SRT标准规范
- 支持特殊字符和标点符号

#### NFR3: 可用性要求
- 命令行界面简单易用
- 清晰的错误提示和帮助信息
- 处理进度显示
- 支持中断和恢复

#### NFR4: 兼容性
- 支持macOS、Linux、Windows
- Python 3.8+环境
- 现代CPU（支持AVX指令集）
- 本地LLM模型兼容性

## Success Criteria

### 核心指标
- **用户采用率**：3个月内获得100+活跃用户
- **翻译质量**：用户满意度评分 > 4.0/5.0
- **处理效率**：平均处理速度达到3倍实时播放速度
- **准确率**：字幕时间同步准确率 > 95%

### 业务指标
- **用户留存率**：30天留存率 > 60%
- **功能使用率**：校对功能使用率 > 30%
- **扩展成功**：6个月内支持5+语言对

### 技术指标
- **系统稳定性**：崩溃率 < 1%
- **资源利用率**：CPU使用率峰值 < 80%
- **文件兼容性**：MP4文件支持率 > 98%

## Constraints & Assumptions

### 技术约束
- 必须使用本地LLM，不依赖云端API
- 仅支持MP4视频格式输入
- 仅输出SRT字幕格式
- 依赖现有的开源语音识别模型

### 资源约束
- 开发周期：8-12周
- 开发人员：1-2人
- 硬件要求：支持本地LLM运行的现代计算机

### 外部假设
- 用户具备基本的命令行操作能力
- 目标用户有足够的计算资源运行本地LLM
- 开源LLM模型质量持续改进

## Out of Scope

### V1.0不包含的功能
- ❌ 批量视频处理
- ❌ 实时字幕翻译
- ❌ 除MP4外的视频格式支持
- ❌ 除SRT外的字幕格式输出
- ❌ 图形用户界面（GUI）
- ❌ 字幕样式和特效
- ❌ 视频编辑功能
- ❌ 云端存储和同步
- ❌ 多用户和权限管理

### 未来版本考虑
- 批量处理能力
- 更多语言支持（韩语、德语、法语等）
- 图形化界面
- 视频格式扩展（AVI、MOV等）
- 字幕格式扩展（VTT、ASS等）

## Dependencies

### 外部依赖
- **Whisper模型**：OpenAI Whisper或类似的语音识别模型
- **本地LLM**：支持多语言翻译的LLM模型（如Llama、Qwen等）
- **FFmpeg**：音频提取和处理
- **Python生态**：相关音频处理和ML库

### 内部依赖
- 无特定的内部团队依赖
- 需要了解视频处理和NLP技术的开发人员

### 关键路径
1. 语音识别模型选择和集成 → 翻译模型集成 → 字幕格式化 → 用户界面开发
2. 模型性能优化是项目成功的关键因素

## Technical Architecture Overview

### 核心组件
1. **音频提取器**：从MP4中提取音频流
2. **语音识别引擎**：生成原文字幕和时间轴
3. **翻译引擎**：本地LLM翻译服务
4. **字幕格式化器**：生成标准SRT文件
5. **校对工具**：可选的人工校对界面

### 数据流
```
MP4视频 → 音频提取 → 语音识别 → 原文字幕 → LLM翻译 → 双语字幕格式化 → SRT文件输出
                                                ↓
                                         可选人工校对
```

## Risk Assessment

### 高风险
- **翻译质量风险**：本地LLM翻译质量可能不稳定
- **性能风险**：大文件处理可能超出用户硬件能力

### 中风险
- **兼容性风险**：不同MP4编码格式可能存在兼容问题
- **用户体验风险**：命令行界面可能对部分用户不够友好

### 缓解策略
- 提供多个LLM模型选择和性能调优选项
- 实现分片处理大文件的机制
- 提供详细的用户文档和故障排除指南